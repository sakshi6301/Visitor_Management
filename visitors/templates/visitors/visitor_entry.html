{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Visitor Entry</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'visitors/css/visitor_entry.css' %}">
</head>

<body class="dashboard-body">

<div class="container-fluid d-flex justify-content-center align-items-center min-vh-100">
    <div class="card entry-card shadow">

        <!-- HEADER -->
        <div class="card-header entry-header">
            <h5 class="mb-0">Visitor Entry Form</h5>
        </div>

        <!-- BODY -->
        <div class="card-body">
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}

                <div class="row g-3">

                    <!-- Name -->
                    <div class="col-md-6">
                        <label class="form-label">Name <span class="text-danger">*</span></label>
                        <input type="text" name="name" class="form-control" required>
                    </div>

                    <!-- Mobile -->
                    <div class="col-md-6">
                        <label class="form-label">Mobile <span class="text-danger">*</span></label>
                        <input type="text"
                               name="mobile"
                               class="form-control"
                               required
                               maxlength="10"
                               pattern="[0-9]{10}"
                               title="Enter 10 digit mobile number">
                    </div>

                    <!-- Email -->
                    <div class="col-md-6">
                        <label class="form-label">Email <span class="text-danger">*</span></label>
                        <input type="email"
                               name="email"
                               class="form-control"
                               placeholder="example@email.com"
                               required>
                    </div>

                    <!-- Gender -->
                    <div class="col-md-6">
                        <label class="form-label">Gender <span class="text-danger">*</span></label>
                        <select name="gender" class="form-select" required>
                            <option value="">Select</option>
                            <option>Male</option>
                            <option>Female</option>
                            <option>Other</option>
                        </select>
                    </div>
                    <!-- Address -->
                    <div class="col-12">
                        <label class="form-label">Address <span class="text-danger">*</span></label>
                        <textarea name="address" rows="2" class="form-control" required></textarea>
                    </div>

                    <!-- Aadhaar Number -->
                    <div class="col-md-6">
                        <label class="form-label">Aadhaar Number <span class="text-danger">*</span></label>
                        <input type="text"
                               name="aadhaar"
                               class="form-control"
                               placeholder="12-digit Aadhaar number"
                               maxlength="12"
                               pattern="[0-9]{12}"
                               required>
                    </div>

                    <!-- Purpose -->
                    <div class="col-md-6">
                        <label class="form-label">Purpose <span class="text-danger">*</span></label>
                        <input type="text" name="purpose" class="form-control" required>
                    </div>

                    <!-- Visit To -->
                    <div class="col-md-6">
                        <label class="form-label">Visit To <span class="text-danger">*</span></label>
                        <input type="text" name="visit_to" class="form-control" required>
                    </div>

                    <!-- Host Email (for notification) -->
                    <div class="col-md-6">
                        <label class="form-label">Host Email <span class="text-muted">(Optional)</span></label>
                        <input type="email" name="host_email" class="form-control" placeholder="host@example.com">
                        <small class="text-muted">Email notification will be sent</small>
                    </div>

                    <!-- Host Mobile (for SMS) -->
                    <div class="col-md-6">
                        <label class="form-label">Host Mobile <span class="text-muted">(Optional)</span></label>
                        <input type="text" name="host_mobile" class="form-control" placeholder="10-digit number" maxlength="10" pattern="[0-9]{10}">
                        <small class="text-muted">SMS notification will be sent</small>
                    </div>

                    <!-- Scheduled Entry Time -->
                    <div class="col-md-6">
                        <label class="form-label">Scheduled Entry Time <span class="text-muted">(Optional)</span></label>
                        <input type="datetime-local" name="scheduled_entry_time" class="form-control">
                        <small class="text-muted">Leave blank for immediate entry</small>
                    </div>

                    <!-- Hostel / Office -->
<div class="col-md-6">
    <label class="form-label">
        Hostel / Office <span class="text-danger">*</span>
    </label>
    <select name="hostel_or_office" class="form-select" required>
        <option value="">Select Hostel / Office</option>

        <!-- Hostels -->
        <option>Dr. Achyutrav Shankar Apte Hostel</option>
        <option>P.D. Karkhanis Hostel</option>
        <option>Lala Lajpatrai Vidyarthi Bhavan</option>
        <option>Sumitra Sadan Hostel</option>
        <option>Medhavi Hostel</option>
        <option>New Girls Hostel – A Wing</option>
        <option>Latika Gaytonde Hostel</option>
        <option>Ahilyanagar Girls Hostel</option>
        <option>Ahilyanagar Boys Hostel</option>
        <option>Haribhau Pathak Hostel</option>

        <!-- Offices -->
        <option>Main Office – New Hostel</option>
        <option>Apte Office – FC</option>
    </select>
</div>


                    

                    <!-- Visitor Photo -->
<!-- Visitor Photo -->
<div class="col-md-6">
    <label class="form-label">
        Visitor Photo <span class="text-muted">(Optional)</span>
    </label>

    <div class="d-flex gap-2 mb-2">
        <input type="file" id="galleryInput" accept="image/*" class="d-none">

        <button type="button" id="galleryBtn"
                class="btn btn-outline-primary btn-sm">
            Upload from Gallery
        </button>

        <button type="button" id="cameraBtn"
                class="btn btn-outline-success btn-sm">
            Open Camera
        </button>

        <button type="button" id="switchBtn"
                class="btn btn-outline-dark btn-sm d-none">
            Switch Camera
        </button>
    </div>

    <video id="camera" class="w-100 rounded border d-none"
           autoplay playsinline style="height:220px; object-fit:cover"></video>

    <div class="mt-2">
        <button type="button" id="captureBtn"
                class="btn btn-success btn-sm d-none">
            Capture
        </button>

        <button type="button" id="retakeBtn"
                class="btn btn-warning btn-sm d-none">
            Retake
        </button>
    </div>

    <canvas id="photoCanvas" class="d-none"></canvas>

    <img id="photoPreview" class="img-fluid rounded mt-2 d-none">

    <!-- ONLY ONE photo field submitted -->
    <input type="file" name="photo" id="finalPhotoInput" class="d-none">

    <small class="text-muted d-block mt-2">
        Gallery upload or live camera capture supported.
    </small>
</div>

                    <!-- Signature -->
<div class="col-12">
    <label class="form-label">
        Signature <span class="text-danger">*</span>
    </label>

    <canvas id="signaturePad"
            width="400"
            height="150"
            style="border:1px solid #ccc; border-radius:8px;">
    </canvas>

    <input type="hidden" name="signature_data" id="signatureData">

    <small class="text-muted d-block mt-1">
        Please ask the visitor to sign before submitting.
    </small>

    <div class="mt-2">
        <button type="button" id="clearSign"
                class="btn btn-sm btn-outline-secondary">
            Clear
        </button>
    </div>
</div>

<!-- Remark -->
<div class="col-12 mt-3">
    <label class="form-label">
        Remark <span class="text-muted">(Optional)</span>
    </label>
    <textarea name="remark"
              class="form-control"
              rows="3"
              placeholder="Any additional remark or note..."></textarea>

    <small class="text-muted">
        Use this field for any special note related to the visitor.
    </small>
</div>

                <!-- ACTION BUTTONS -->
                <div class="d-flex justify-content-between mt-4">
                    <a href="{% url 'visitor_list' %}" class="btn btn-secondary">
                        Back
                    </a>
                    <button type= "submit" class="btn btn-primary px-4">
                        Submit Visitor
                    </button>
                </div>

            </form>
        </div>
    </div>
</div>

<!-- JS -->
<script src="{% static 'visitors/js/visitor_entry.js' %}"></script>

</body>
</html>
